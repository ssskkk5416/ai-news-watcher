# ai-news-watcher
AI最新ニュースを分かりやすく閲覧するアプリケーション

## PDF取り込み方式
以下の方式を採用します。

- **手動アップロード**: 画面からPDFをアップロードして取り込みます。
- **指定フォルダの監視**: ローカルの指定フォルダを監視し、新規PDFを自動取り込みします。
- **初回一括インポート**: 既存のPDFフォルダを指定して初回のみ一括取り込みします。

## 保存先とディレクトリ構成
保存先はローカルディスクとします（外部ストレージやDBは利用しません）。

```
data/
  incoming/    # 監視対象フォルダ（未取り込みPDF）
  imported/    # 取り込み済みPDF
  metadata/    # 解析結果やメタデータ（JSON等）
  logs/        # 取り込みログ
```

## セキュリティ
- 取り込み処理はローカル環境で完結します。
- PDFデータやメタデータを外部へ送信しません。
## メタデータ抽出モジュール設計

`src/metadata/extract.ts` をメタデータ抽出の責務を持つモジュールとして定義する。

- `MetadataSource`: URL と HTML 本文を受け取る入力構造。
- `MetadataExtractionRules`: 抽出対象ごとのセレクタ優先順位・フォールバックを定義するルール。
- `MetadataExtractionResult`: タイトル候補、発行日、主要トピック、警告情報をまとめた結果構造。
- `extractMetadata`: 抽出処理のエントリーポイント。ルールを差し替え可能にし、将来的にパーサや正規化処理を差し込める設計。

## 抽出対象とルール

### タイトル候補
1. `meta[property="og:title"]`
2. `meta[name="twitter:title"]`
3. `meta[name="title"]`
4. `h1`
5. フォールバックとして `title`, `h2`

> 取得できたタイトルは出現順に `titleCandidates` に格納し、重複は除外する。

### 発行日
- 優先順: `meta[property="article:published_time"]` → `meta[name="pubdate"]` → `meta[name="publish-date"]` → `time[datetime]`
- 取得した値は ISO 8601 に正規化する（正規化不可の場合は `publishedAt` を空にし、警告を残す）。

### 主要トピック
- 優先順: `meta[property="article:tag"]` → `meta[name="keywords"]` → `[data-topic]` → `.tag`
- 取得したトピックは正規化（前後空白除去・小文字化）し、最大 5 件まで `mainTopics` に格納する。

## フロント検索UI要件

### 検索条件
- **キーワード検索**: ニュース本文・タイトル・タグを対象に AND/OR 切替を可能にする。
- **日付フィルタ**: 開始日・終了日を指定するレンジフィルタ。未指定の場合は全期間。
- **タグ**: トピックタグの複数選択に対応。選択タグは OR 条件でフィルタ。

### UI コンポーネント
- 検索バー（キーワード入力 + AND/OR 切替）
- 日付レンジピッカー
- タグチップ/マルチセレクト
- 適用中のフィルタを表示する「フィルタサマリ」
- クリアボタン（全条件リセット）

### インタラクション
- 入力変更時に即時検索（デバウンス 300ms 推奨）。
- 条件更新後、結果件数と現在のフィルタを表示。
- URL クエリに状態を同期し、共有/再読み込み時に復元可能にする。
